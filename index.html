<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åè¬å¹´å‰ï¼šæ°¸æ†çš„ç«æŸ´äºº</title>
    <style>
        body {
            background: radial-gradient(circle, #4e3b2c 0%, #1a120b 100%);
            margin: 0; height: 100vh; display: flex; justify-content: center; align-items: center;
            font-family: "Microsoft JhengHei", sans-serif; color: #f4e4bc; overflow: hidden;
        }
        #game-container {
            background: rgba(0, 0, 0, 0.6); padding: 30px; border-radius: 20px; border: 4px solid #8b7355;
            display: flex; flex-direction: row; gap: 30px; max-width: 1000px; width: 90%;
        }
        .canvas-section { flex: 1.2; }
        canvas {
            background: #e6d5b8; border: 8px solid #3d2b1f; border-radius: 10px;
            cursor: crosshair; display: block; width: 100%; height: auto; touch-action: none;
        }
        .info-section { flex: 0.8; display: flex; flex-direction: column; justify-content: space-between; }
        h1 { margin: 0; color: #ffa500; font-size: 1.8em; }
        #event-display {
            background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px;
            border-left: 5px solid #ffa500; font-size: 1.1em; min-height: 220px;
        }
        .controls { display: flex; gap: 15px; margin-top: 20px; }
        .btn { flex: 1; padding: 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-primary { background: #d2691e; color: white; }
        .btn-secondary { background: #555; color: #eee; }
        @media (max-width: 800px) { #game-container { flex-direction: column; } }
    </style>
</head>
<body>

    <div id="game-container">
        <div class="canvas-section">
            <canvas id="paintCanvas" width="500" height="500"></canvas>
        </div>

        <div class="info-section">
            <header>
                <h1 id="title">ğŸ¦´ æ´ç©´æ‰‹è¨˜</h1>
                <p id="progress-tag">é€²åº¦ï¼šå¬å–šè‹±é›„</p>
            </header>
            
            <div id="event-display">
                <p id="event-text">ã€åºç« ã€‘<br>ä½ é†’ä¾†ç™¼ç¾è‡ªå·±èººåœ¨å±±æ´è£¡...<br><br><strong>è«‹å…ˆç•«å‡ºä½ çš„ã€Œç«æŸ´äººè‹±é›„ã€ã€‚</strong><br>(ç•«å®Œå¾Œä»–å°‡é™ªä¼´ä½ å…¨ç¨‹ï¼)</p>
            </div>

            <div class="controls">
                <button class="btn btn-secondary" onclick="clearCurrentOnly()">æ“¦æ‰æœ¬æ¬¡</button>
                <button class="btn btn-primary" id="actionBtn" onclick="handleAction()">æˆ‘ç•«å¥½äº†</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('paintCanvas');
        const ctx = canvas.getContext('2d');
        const eventText = document.getElementById('event-text');
        const actionBtn = document.getElementById('actionBtn');
        const progressTag = document.getElementById('progress-tag');

        let painting = false;
        let step = 0; // 0:åºç« , 1-4:å†’éšª, 5:æ™‚å…‰æ©Ÿ, 6:çµå±€
        
        // é›¢å±ç•«å¸ƒï¼šç”¨ä¾†ä¿å­˜æ¯ä¸€éšæ®µç¢ºå®šçš„åœ–æ¡ˆ
        const saveCanvas = document.createElement('canvas');
        saveCanvas.width = 500; saveCanvas.height = 500;
        const saveCtx = saveCanvas.getContext('2d');

        const adventureList = [
            { q: "ã€ç¬¬ä¸€é—œã€‘", t: "ä¸€é ­çŒ›ç‘ªè±¡è¡éä¾†äº†ï¼", a: "åœ¨è‹±é›„èº«é‚Šç•«å‡ºã€é•·çŸ›ã€‘æˆ–ã€é™·é˜±ã€‘ï¼" },
            { q: "ã€ç¬¬äºŒé—œã€‘", t: "å¤©é»‘äº†ï¼Œç‹¼ç¾¤åœ¨é è¿‘...", a: "åœ¨è‹±é›„èº«é‚Šç•«å‡ºã€ç«å †ã€‘æˆ–ã€ç«æŠŠã€‘ï¼" },
            { q: "ã€ç¬¬ä¸‰é—œã€‘", t: "å‰æ–¹å‡ºç¾ç™¾ç±³æ·±çš„å¤§è£‚è°·ï¼", a: "ç•«å‡ºã€ç¿…è†€ã€‘æˆ–ã€é•·æ©‹ã€‘è®“è‹±é›„é€šéï¼" },
            { q: "ã€ç¬¬å››é—œã€‘", t: "åŸå§‹äººéƒ¨è½æƒ³çœ‹ä½ çš„å¯¶ç‰©...", a: "ç•«å‡ºã€é‡‘å¹£ã€‘æˆ–ã€æ‰‹æ©Ÿã€‘åš‡å£ä»–å€‘ï¼" },
            { q: "ã€æœ€çµ‚é—œã€‘", t: "æ™‚ç©ºè£‚ç¸«å‡ºç¾äº†ï¼", a: "å¿«ç•«å‡ºã€æ™‚å…‰æ©Ÿã€‘æˆ–æ˜¯ã€ä»»æ„é–€ã€‘å›å®¶ï¼" }
        ];

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            let cx = e.touches ? e.touches[0].clientX : e.clientX;
            let cy = e.touches ? e.touches[0].clientY : e.clientY;
            return {
                x: (cx - rect.left) * (canvas.width / rect.width),
                y: (cy - rect.top) * (canvas.height / rect.height)
            };
        }

        function startPosition(e) { painting = true; draw(e); }
        function finishedPosition() { painting = false; ctx.beginPath(); }
        
        function draw(e) {
            if (!painting) return;
            e.preventDefault();
            const pos = getPos(e);
            ctx.lineWidth = 5; ctx.lineCap = 'round'; ctx.strokeStyle = '#2b1d12';
            ctx.lineTo(pos.x, pos.y); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(pos.x, pos.y);
        }

        canvas.addEventListener('mousedown', startPosition);
        canvas.addEventListener('mousemove', draw);
        window.addEventListener('mouseup', finishedPosition);
        canvas.addEventListener('touchstart', startPosition);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', finishedPosition);

        // ã€Œæ“¦æ‰æœ¬æ¬¡ã€åªæœƒå›åˆ°è©²éšæ®µå‰›é–‹å§‹çš„æ¨£å­ï¼ˆä¿ç•™ä¹‹å‰çš„ç«æŸ´äººï¼‰
        function clearCurrentOnly() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(saveCanvas, 0, 0);
        }

        function handleAction() {
            // å…ˆä¿å­˜ç•¶å‰ç•«é¢åˆ°ã€Œæ°¸æ†ç•«å¸ƒã€
            saveCtx.clearRect(0, 0, 500, 500);
            saveCtx.drawImage(canvas, 0, 0);

            if (step < 5) {
                const ev = adventureList[step];
                progressTag.innerText = `å†’éšªé€²åº¦ï¼š${step + 1} / 5`;
                eventText.innerHTML = `<b style="color:#ffa500; font-size:1.2em;">${ev.q} ${ev.t}</b><br><br>${ev.a}`;
                actionBtn.innerText = (step === 4) ? "ç™¼å‹•æ™‚å…‰æ©Ÿï¼" : "è§£æ±ºé›£é¡Œï¼";
                step++;
            } else {
                showEnding();
            }
        }

        function showEnding() {
            progressTag.innerText = "çµå±€ï¼šå›åˆ°ç¾ä»£";
            eventText.innerHTML = `
                <b style="color:#00ff00; font-size:1.3em;">ğŸŒ€ æˆåŠŸé€šé—œï¼</b><br><br>
                ä½ çš„è‹±é›„å¸¶è‘—æ‰€æœ‰è£å‚™è·³é€²äº†æ™‚å…‰æ©Ÿï¼<br><br>
                ç™½å…‰é–ƒé...ä½ å›åˆ°äº†2026å¹´ã€‚<br>
                å·¦å´æ˜¯ä½ å‰›æ‰å¥®åŠ›æ±‚ç”Ÿçš„ã€Œå£ç•«è­‰æ“šã€ã€‚
            `;
            actionBtn.innerText = "å†æ¬¡è½‰ç”Ÿ";
            actionBtn.onclick = () => location.reload();
            document.querySelector('.btn-secondary').style.display = "none";
        }
    </script>
</body>
</html>
           
