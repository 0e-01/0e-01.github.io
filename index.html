<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åè¬å¹´å‰ï¼šæ´ç©´å†’éšª</title>
    <style>
        /* å…¨åŸŸæ¨£å¼ */
        body {
            background: radial-gradient(circle, #4e3b2c 0%, #1a120b 100%);
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
            color: #f4e4bc;
            overflow: hidden;
        }

        /* éŠæˆ²å®¹å™¨ï¼šå¼·åˆ¶å·¦å³æ’åˆ— */
        #game-container {
            background: rgba(0, 0, 0, 0.5);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #8b7355;
            display: flex; 
            flex-direction: row; /* é—œéµï¼šå·¦å³æ’åˆ— */
            gap: 30px;
            max-width: 1000px;
            width: 90%;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }

        /* å·¦å´ï¼šç•«æ¿å€ */
        .canvas-section {
            flex: 1.2;
            position: relative;
        }

        canvas {
            background: #e6d5b8;
            border: 10px solid #3d2b1f;
            border-radius: 10px;
            cursor: crosshair;
            display: block;
            width: 100%; /* é©æ‡‰å®¹å™¨å¯¬åº¦ */
            height: auto;
            touch-action: none; /* é˜²æ­¢æ‰‹æ©Ÿæ²å‹•å¹²æ“¾ç•«åœ– */
        }

        /* å³å´ï¼šæ–‡å­—èˆ‡æŒ‰éˆ•å€ */
        .info-section {
            flex: 0.8;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            text-align: left;
        }

        h1 { margin-top: 0; color: #ffa500; font-size: 2em; text-shadow: 2px 2px #000; }

        #event-display {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ffa500;
            font-size: 1.2em;
            line-height: 1.6;
            min-height: 150px;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 15px 10px;
            font-size: 1.1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s, background 0.2s;
        }

        .btn-primary { background: #d2691e; color: white; box-shadow: 0 4px #8b4513; }
        .btn-primary:active { transform: translateY(4px); box-shadow: none; }
        
        .btn-secondary { background: #555; color: #eee; }

        /* æ‰‹æ©Ÿæ¨¡å¼è‡ªå‹•åˆ‡æ›å›ä¸Šä¸‹æ’åˆ— */
        @media (max-width: 800px) {
            #game-container { flex-direction: column; height: auto; overflow-y: auto; }
            canvas { height: 300px; }
        }
    </style>
</head>
<body>

    <div id="game-container">
        <div class="canvas-section">
            <canvas id="paintCanvas" width="500" height="500"></canvas>
        </div>

        <div class="info-section">
            <header>
                <h1>ğŸ¦´ æ´ç©´æ‰‹è¨˜</h1>
                <p>ç©¿è¶Šæ™‚ç©ºï¼šåè¬å¹´å‰çš„è’é‡</p>
            </header>
            
            <div id="event-display">
                <p id="event-text">ã€åºç« ã€‘<br>ä½ é†’ä¾†ç™¼ç¾è‡ªå·±èººåœ¨å±±æ´è£¡...<br><br><strong>è«‹åœ¨å·¦å´ç•«å‡ºä½ çš„ç«æŸ´äººåŒ–èº«ã€‚</strong></p>
            </div>

            <div class="controls">
                <button class="btn btn-secondary" onclick="clearCanvas()">æ“¦æ‰</button>
                <button class="btn btn-primary" id="actionBtn" onclick="handleAction()">æˆ‘ç•«å¥½äº†</button>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('paintCanvas');
        const ctx = canvas.getContext('2d');
        const eventText = document.getElementById('event-text');
        const actionBtn = document.getElementById('actionBtn');

        let painting = false;
        let gameState = "start";

        const adventures = [
            { q: "ã€çªç™¼ã€‘å‰æ–¹å‡ºç¾ä¸€é ­æ†¤æ€’çš„çŒ›ç‘ªè±¡ï¼", a: "å¿«ç•«å‡ºä¸€å€‹ã€æ·±å‘é™·é˜±ã€‘æˆ–æ˜¯ã€å·¨å¤§çš„é•·çŸ›ã€‘ï¼" },
            { q: "ã€çªç™¼ã€‘é»‘å¤œé™è‡¨ï¼Œé™„è¿‘çš„ç‹¼ç¾¤é–‹å§‹åšå«...", a: "ç•«å‡ºã€ä¸€å †ç«ã€‘æˆ–æ˜¯ã€å …å›ºçš„æŸµæ¬„ã€‘ï¼" },
            { q: "ã€çªç™¼ã€‘ä½ ç™¼ç¾äº†ç‰†ä¸Šçš„ç¥ç¥•åœ–é¨°ï¼Œéœ€è¦ç¥­å“...", a: "ç•«å‡ºã€ä¸€æ¢é­šã€‘æˆ–æ˜¯ã€å¥‡ç•°æœå¯¦ã€‘ä¾†ç»ç¥­ï¼" },
            { q: "ã€çªç™¼ã€‘å‰æ–¹å±±è·¯å´©å¡Œï¼Œéœ²å‡ºå¤§è£‚è°·ï¼", a: "ç•«å‡ºã€ä¸€æ¢ç¹©ç´¢ã€‘æˆ–æ˜¯ã€é•·æ¢¯å­ã€‘çˆ¬éå»ï¼" }
        ];

        // ä¿®æ­£å¾Œçš„åº§æ¨™è¨ˆç®—å‡½æ•¸
        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            // è€ƒæ…®åˆ° CSS ç¸®æ”¾ï¼Œè¨ˆç®—æ­£ç¢ºæ¯”ä¾‹
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            let clientX, clientY;
            if (e.touches) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }
            
            return {
                x: (clientX - rect.left) * scaleX,
                y: (clientY - rect.top) * scaleY
            };
        }

        function startPosition(e) {
            painting = true;
            draw(e);
        }

        function finishedPosition() {
            painting = false;
            ctx.beginPath();
        }

        function draw(e) {
            if (!painting) return;
            e.preventDefault();
            
            const pos = getPos(e);

            ctx.lineWidth = 6;
            ctx.lineCap = 'round';
            ctx.strokeStyle = '#2b1d12';

            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        // æ»‘é¼ ç›£è½
        canvas.addEventListener('mousedown', startPosition);
        canvas.addEventListener('mousemove', draw);
        window.addEventListener('mouseup', finishedPosition);

        // è§¸æ§ç›£è½
        canvas.addEventListener('touchstart', startPosition);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', finishedPosition);

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function handleAction() {
            if (gameState === "start" || gameState === "result") {
                triggerNewEvent();
            } else if (gameState === "adventure") {
                const results = ["å¥‡è¹Ÿç™¼ç”Ÿäº†ï¼ä½ çš„ç•«ä½œè®Šæˆäº†å¯¦é«”ï¼", "é›–ç„¶ç•«å¾—æœ‰é»é†œï¼Œä½†å±…ç„¶å¥æ•ˆäº†ï¼", "é è‘—é€™å€‹å·¥å…·ï¼Œä½ é †åˆ©åŒ–éšªç‚ºå¤·ã€‚"];
                eventText.innerHTML = `<span style="color:#00ff00">âœ” æˆåŠŸç”Ÿå­˜ï¼</span><br><br>${results[Math.floor(Math.random()*results.length)]}`;
                actionBtn.innerText = "ç¹¼çºŒå‰è¡Œ";
                gameState = "result";
            }
        }

        function triggerNewEvent() {
            clearCanvas();
            const ev = adventures[Math.floor(Math.random() * adventures.length)];
            eventText.innerHTML = `<span style="color:#ffa500; font-weight:bold;">${ev.q}</span><br><br>${ev.a}`;
            actionBtn.innerText = "ç•«å¥½äº†ï¼Œè§£æ±ºå®ƒï¼";
            gameState = "adventure";
        }
    </script>
</body>
</html>
