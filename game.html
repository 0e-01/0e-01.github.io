<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>天線寶寶小遊戲</title>
<style>
  body { text-align: center; }
  canvas { border: 2px solid #333; }
</style>
</head>
<body>

<h3>⬆️ 跳躍　避開毛毛蟲</h3>
<canvas id="game" width="400" height="200"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let y = 140;
let vy = 0;
let score = 0;
let obstacleX = 420;

document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp" && y === 140) vy = -10;
});

function drawCaterpillar(x) {
  ctx.fillStyle = "green";
  for (let i = 0; i < 4; i++) {
    ctx.beginPath();
    ctx.arc(x + i * 12, 155, 6, 0, Math.PI * 2);
    ctx.fill();
  }
}

function loop() {
  ctx.clearRect(0,0,400,200);

  // 天線寶寶（玩家）
  ctx.fillStyle = "orange";
  ctx.fillRect(50, y, 20, 40);

  y += vy;
  vy += 0.6;
  if (y > 140) { y = 140; vy = 0; }

  // 毛毛蟲
  drawCaterpillar(obstacleX);
  obstacleX -= 4;

  if (obstacleX < -50) {
    obstacleX = 420;
    score += 10;
  }

  ctx.fillStyle = "#000";
  ctx.fillText("分數：" + score, 10, 20);

  if (obstacleX < 80 && obstacleX > 40 && y > 120) {
    endGame();
    return;
  }

  requestAnimationFrame(loop);
}

function endGame() {
  let money = Number(localStorage.getItem("money")) || 0;
  let reward = Math.floor(score / 100) * 10;
  money += reward;
  localStorage.setItem("money", money);
  alert("遊戲結束！獲得 $" + reward);
  window.location.href = "index.html";
}

loop();
</script>

</body>
</html>

  
  
